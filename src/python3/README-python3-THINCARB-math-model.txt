THINCARB_py3_math.py

This is the Python 3.x.x source code for an implementation of the original Neal et al (1998) Lotus 1-2-3 macro (see [1]). This spreadsheet also extends the calculations to provide Total Dissolved Inorganic Carbon (DIC) concentrations[2], and provides for a site (ie, location/station) field to aid the interpretation of large datasets. To all intents and purposes this file is a Pythonic version of the spreadsheet THINCARB-excel2010.xlsm. This file is provided for reference purposes only. It can be opened and read using any ASCII-compatible text editor. Do not edit this file. Edit one of the call handler routines instead.

THINCARB_py3_math.py uses the Python math library for exponentiation, square root and log10 functions whereas THINCARB_py3.py only use the math library for log10 functions and the ** operator for exponentiation and square root.

IMPORTANT NOTE: this file also corrects an error in the original altitude correction applied to EpCO2 values.



__pycache__

(If present) This is a folder containing the Python 3.x.x compiled byte code.



THINCARB_py3_math.cpython-34.pyc

(If present) This is the compiled byte code version of THINCARB_py3.py executed by the Python virtual machine.



call_THINCARB_py3_from_list.py

This is the Python 3.x.x source code for a handler routine to call THINCARB_py3.pyc using input values stored as Python list variables in the call handler itself. This file can be opened and read using any ASCII-compatible text editor. To utilise this file, edit in your own data between lines 11 - 38, and provide a name for the output file to contain the optimised values of EpCO2 and DIC.



call_THINCARB_py3_from_file.py

This is the Python 3.x.x source code for a handler routine to call THINCARB_py3.pyc using input values stored in a separate input file. This file can be opened and read using any ASCII-compatible text editor. To utilise this file, edit it to provide the names of the input data file and the output file to contain the optimised values of EpCO2 and DIC. Also match the variables A - G to the columns in the input data file.



THINCARB_model_table5_test_data.txt

This is an example of an input data file to be used with call_THINCARB_py3_from_file.py. The date and time are dummy values.

IMPORTANT NOTE: the columns of data must be separated by a single space!



THINCARB_model_results_from_calculation_LIST.txt

This is example output from executing call_THINCARB_py3_from_list.py



THINCARB_model_results_from_calculation_FILE.txt

This is example output from executing call_THINCARB_py3_from_file.py



REFERENCES

[1] 'An assessment of excess carbon dioxide partial pressures in natural waters based on pH and alkalinity measurements'. Colin Neal, W Alan House, Kevin Down. The Science of the Total Environment. 210/211 (1998) 173-185.

[2] 'Inorganic carbon dominates total dissolved carbon concentrations and fluxes in British rivers: Application of the THINCARB model – Thermodynamic modelling of inorganic carbon in freshwaters'. Helen Jarvie, Stephen King, Colin Neal. Science of the Total Environment. 575 (2017) 496-512.



RELEASE NOTES

13-Mar-2018: Prior versions of THINCARB_py3_math.py contained a bug which caused the bisection optimiser to misbehave. This has now been trapped. The fix does not impact any of the outputs of the model.

14-Jul-2017: Prior versions of THINCARB_py3_math.py were computing an altitude-compensated EpCO2 value (L) but not actually implementing it in the calculation of the H2CO3 activity (Y). This is now fixed.


